---
title: "Gapminder; Assignment 3"
author: "Ole Alexander Bakkevik & Sindre M. Espedal"
subtitle: MSB - 105
output:
  html_document:
    df_print: paged
  html_notebook: default
  pdf_document: default
---

```{r setup, message=FALSE, echo=FALSE}
library(tibble)
library(readr)
library(knitr)
library(dplyr)
library(tidyverse)
library(tinytex)
options(scipen = 333)
```


# Spørsmål 1

*ddf--concepts.csv* filen er en tekstfil uten verdier. Innholdet er
beskrivelser av forskjellige variabler. Som for eksempel
populasjonsforhold, dødsårsaker, sykdommer (HIV, tuberkulose),
arbeidsledighet og yrkesaktive, aldersgrupper. Det er også beskrevet de
respektive landenes mikro/makroøkonimiske forhold som BNP osv.


# Spørsmål 2

*ddf--entities--geo--country.csv* henviser til en kort beskrivelse av
alle verdens land og stater. Samtidig som informasjon om landet er
anerkjent som et land eller ikke. Beskrivelsen innholder også geografisk
lokasjon verdensdel/region, FN-tilhørighet og antatt levestandard.


# Spørsmål 3

*ddf--entities--geo--un_sdg_region.csv* beskriver hvilke områder som er
anerkjent som FN-regioner.

```{r}
library(readr)
g_c <- read_csv("ddf--gapminder--systema_globalis-master/ddf--entities--geo--country.csv")
print(g_c)
```


# Spørsmål 4

Gapminder datasettet fra gapminder pakken inneholder 6 variabler. disse
er:

-   *country* -\> land, med 142 leveler.
-   *continent* -\> kontinenter, med 5 leveler.
-   *year* -\> år, varier fra 1952 til 2007 i trinn på 5 år.
-   *lifeExp* -\> forventet leveår, målt i år.
-   *pop* -\> befolkning
-   *gdpPercap* -\> BNP per innbygger, US\$ inflasjon-justert

```{r}
library(readr)
oppg_4 <- ddf_entities_geo_country <- read_csv("ddf--gapminder--systema_globalis-master/ddf--entities--geo--country.csv")
  print(oppg_4)
```

Vi ser ut i fra datasettet *ddf:entities_geo_country.csv* at Australia
og New Zealand tilhører *east_asia_pacific*, altså Asia.


# Spørsmål 5

```{r}
g_c <- g_c %>%
  mutate(continent = case_when(
     world_4region == "asia" & un_sdg_region %in% c("un_australia_and_new_zealand", "un_oceania_exc_australia_and_new_zealand") ~ "Oceania",
    world_4region ==  "asia" & !(un_sdg_region %in% c("un_australia_and_new_zealand", "un_oceania_exc_australia_and_new_zealand")) ~ "Asia",
    world_4region == "africa" ~ "Africa",
    world_4region == "americas" ~ "Americas",
    world_4region ==  "europe" ~ "Europe")
  ) %>%
 filter(!is.na(iso3166_1_alpha3))
```


# Spørsmål 6

## a)

```{r}
length(unique(g_c$country))
```
Nå er det 247 land. 

# Spørsmål 6

## b)

```{r}
g_c %>%
  group_by(continent) %>%
  summarise(countries = length(unique(country)))
```


# Spørsmål 7

```{r}

lifeExp <- read_csv("ddf--gapminder--systema_globalis-master/countries-etc-datapoints/ddf--datapoints--life_expectancy_years--by--geo--time.csv",

col_types = cols(time = col_date(format = "%Y")))
lifeExp <- lifeExp %>%
rename(year = time)
names(lifeExp)
length(unique(lifeExp$geo))
```


# Spørsmål 8

```{r}
length(unique(lifeExp$geo))
```

Det er 195 land som informasjon om forventet levetid.


# Spørsmål 9

```{r}
g_c <- g_c %>%
select(country,
       name,
       iso3166_1_alpha3,
       un_sdg_region,
       world_4region,
       continent,
       world_6region,
       ) %>%
left_join(lifeExp, by = c("country" = "geo")) %>%
filter(!(is.na(year) & is.na(life_expectancy_years))) %>%
filter(year < "2020-01-01") 
```

```{r}
names(g_c)
```


# Spørsmål 10

```{r}
g_c_min <- g_c %>% 
  group_by(country) %>% 
  summarise(min_year = min(year))
table(g_c_min$min_year)
```

Fra 1800 er det 186 land som har forventet levealder, mens de resterende 9 andre landene har fra 1950.


# Spørsmål 11

```{r}
g_c_min <- g_c_min %>%
  left_join(g_c,
            by = "country") %>%
  filter(min_year == "1950-01-01")
tibble(country = unique(g_c_min$name))
rm(g_c_min)
```

Dette er de 9 landene som har data om forventet levealder kun fra 1950.


# Spørsmål 12

```{r pop}
pop <- read_csv("ddf--gapminder--systema_globalis-master/countries-etc-datapoints/ddf--datapoints--population_total--by--geo--time.csv", 
    col_types = cols(time = col_date(format = "%Y")))
```

```{r join_pop}
g_c <- g_c %>%
  left_join(pop, by = c("country" = "geo", "year" = "time"))
rm(pop)
```


# Spørsmål 13

```{r gdp_pc}
gdp_pc <- read_csv("ddf--gapminder--systema_globalis-master/countries-etc-datapoints/ddf--datapoints--gdppercapita_us_inflation_adjusted--by--geo--time.csv", 
    col_types = cols(time = col_date(format = "%Y")))
```

```{r join_gdp_pc}
g_c <- g_c %>%
  left_join(gdp_pc, by = c("country" = "geo", "year" = "time"))
rm(gdp_pc)
```

```{r}
g_c = g_c %>% 
  rename("lifeExp" = "life_expectancy_years",
         "pop" = "population_total",
         "gdpPercap" = "gdppercapita_us_inflation_adjusted")
```

```{r names_g_c}
names(g_c)
```

Her har vi gitt nytt navn til 3 variabler, slik at de har samme navn som i *gapminder*-datasettet.


# Spørsmål 14

```{r}
t1 <- paste(c(seq(1800, 2015, by = 5), 2019), "01-01", sep = "-") %>%
  parse_date(format = "%Y-%m-%d")

g_c_5 <- g_c %>%
  filter(year %in% t1) %>%
  select(country, name, continent, year, lifeExp, pop, gdpPercap)
dim(g_c_5)
```

```{r}
g_c_gdpprc <- g_c_5 %>% 
  group_by(gdpPercap) %>% 
  summarise(min_year = min(year))
table(g_c_gdpprc$min_year)
```



# Spørsmål 15

```{r country_1962}
my_gapminder_1962 <- my_gapminder %>%
  group_by(country) %>% 
  filter(!is.na(gdpPercap)) %>%
  filter(year == "1962-01-01")

length(unique(my_gapminder_1962$country))

```

Vi ser her at det kun er 90 land som har data for *gdpPercap* i året 1962.

Under viser vi fordelingen av disse 90 landene, fordelt per kontinent..

```{r continent_1962}
my_gapminder_1962 %>%
distinct(country, continent) %>%
group_by(continent) %>%
count() %>%
kable()
```





