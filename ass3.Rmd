---
title: "Gapminder; Assignment 3"
author: "Ole Alexander Bakkevik & Sindre M. Espedal"
subtitle: MSB - 105
output:
  html_document:
    df_print: paged
  html_notebook: default
  pdf_document: default
---

```{r setup, message=FALSE, echo=FALSE}
library(tibble)
library(readr)
library(knitr)
library(dplyr)
library(tidyverse)
library(tinytex)
options(scipen = 333)
```

# Spørsmål 1

*ddf--concepts.csv* filen er en tekstfil uten verdier. Innholdet er
beskrivelser av forskjellige variabler. Som for eksempel
populasjonsforhold, dødsårsaker, sykdommer (HIV, tuberkulose),
arbeidsledighet og yrkesaktive, aldersgrupper. Det er også beskrevet de
respektive landenes mikro/makroøkonimiske forhold som BNP osv.

# Spørsmål 2

*ddf--entities--geo--country.csv* inneholder kort beskrivelse av alle
verdens land og stater. Dette inkluderer informasjon som beskriver
hvorvidt landet er anerkjent som et land eller ikke. I tillegg ser vi
blant annet også hvilken region/verdensdel det tilhører, levestandard,
FN-tilhørighet og lokasjon

*ddf--entities--geo--country.csv* henviser til en kort beskrivelse av
alle verdens land og stater. Samtidig som informasjon om landet er
anerkjent som et land eller ikke. Beskrivelsen innholder også geografisk
lokasjon verdensdel/region, FN-tilhørighet og antatt levestandard.

# Spørsmål 3

*ddf--entities--geo--un_sdg_region.csv* beskriver hvilke områder som er
anerkjent som FN-regioner.

```{r}
library(readr)
g_c <- read_csv("ddf--gapminder--systema_globalis-master/ddf--entities--geo--country.csv")
print(g_c)
```

# Spørsmål 4

Gapminder datasettet fra gapminder pakken inneholder 6 variabler. disse
er:

-   *country* -\> land, med 142 leveler.
-   *continent* -\> kontinenter, med 5 leveler.
-   *year* -\> år, varier fra 1952 til 2007 i trinn på 5 år.
-   *lifeExp* -\> forventet leveår, målt i år.
-   *pop* -\> befolkning
-   *gdpPercap* -\> BNP per innbygger, US\$ inflasjon-justert

```{r}
library(readr)
oppg_4 <- ddf_entities_geo_country <- read_csv("ddf--gapminder--systema_globalis-master/ddf--entities--geo--country.csv")
  print(oppg_4)
```

Vi ser ut i fra datasettet *ddf:entities_geo_country.csv* at Australia
og New Zealand tilhører *east_asia_pacific*, altså Asia.

# Spørsmål 5
```{r}
g_c <- g_c %>%
  mutate(continent = case_when(
     world_4region == "asia" & un_sdg_region %in% c("un_australia_and_new_zealand", "un_oceania_exc_australia_and_new_zealand") ~ "Oceania",
    world_4region ==  "asia" & !(un_sdg_region %in% c("un_australia_and_new_zealand", "un_oceania_exc_australia_and_new_zealand")) ~ "Asia",
    world_4region == "africa" ~ "Africa",
    world_4region == "americas" ~ "Americas",
    world_4region ==  "europe" ~ "Europe")
  ) %>%
 filter(!is.na(iso3166_1_alpha3))
```



# Spørsmål 6
## a)

```{r}
length(unique(g_c$country))
```
Nå er det 247 land. 

# Spørsmål 6
## b)

```{r}
g_c %>%
  group_by(continent) %>%
  summarise(countries = length(unique(country)))
```


# Spørsmål 7

```{r}
library(readr)
lifeExp <- read_csv("ddf--gapminder--systema_globalis-master/ddf--entities--geo--country/countries-etc-datapoints/ddf_datapoints_life_expectancy_at_birth_data_from_ihme_by_geo_time.csv",
col_types = cols(time = col_date(format = "%Y")))
lifeExp <- lifeExp %>%
rename(year = time)
length(unique(lifeExp$geo))
```


# Spørsmål 8

Det er x antall land som informasjon om levetid.



# Spørsmål 9

```{r}
g_c_min <- g_c %>%
  group_by(country) %>%
  summarise(min_year = min(year)) 

g_c_min %>%
  count(min_year = g_c_min$min_year)
```

# Spørsmål 10

```{r}
pop <- read_csv("ddf--gapminder--systema_globalis-master/ddf--entities--geo--country/countries-etc-datapoints/ddf--datapoints--population_total--by--geo--time.csv", 
    col_types = cols(time = col_date(format = "%Y")))

```

```{r}
g_c <- g_c %>%
  left_join(pop, by = c("country" = "geo", "year" = "time"))

rm(pop)
```


# Spørsmål 11

```{r u_pop}
u_pop <- read_csv("Data/ddf--gapminder--systema_globalis-master/countries-etc-datapoints/ddf--datapoints--urban_population--by--geo--time.csv", 
    col_types = cols(time = col_date(format = "%Y")))
```

```{r join_u_pop}
g_c <- g_c %>%
  left_join(u_pop, by = c("country" = "geo", "year" = "time"))

rm(u_pop)
```

# Spørsmål 12

```{r gdp_pc}
gdp_pc <- read_csv("Data/ddf--gapminder--systema_globalis-master/countries-etc-datapoints/ddf--datapoints--gdppercapita_us_inflation_adjusted--by--geo--time.csv", 
    col_types = cols(time = col_date(format = "%Y")))
```

```{r join_gdp_pc}
g_c <- g_c %>%
  left_join(gdp_pc, by = c("country" = "geo", "year" = "time"))

rm(gdp_pc)
```


```{r names_g_c}
names(g_c)
```

# Spørsmål 13

```{r rename}
g_c <- g_c %>%
  rename("lifeExp" = "life_expectancy_years") %>%
  rename("pop" = "population_total") %>%
  rename("gdpPercap" = "gdppercapita_us_inflation_adjusted")
```

Her har vi gitt nytt navn til 3 variabler, slik at de har samme navn som i *gapminder*-datasettet.

```{r my_gapminder}
t1 <- paste(seq(1962, 2017, by = 5), "01-01", sep = "-") %>% parse_date(format = "%Y-%m-%d")

my_gapminder <- g_c %>%
  filter(year %in% t1) %>%
  select(name, continent, year, lifeExp, pop, gdpPercap) %>%
  rename("country" = "name")

dim(my_gapminder)
```

# Spørsmål 14

```{r country_1962}
my_gapminder_1962 <- my_gapminder %>%
  group_by(country) %>% 
  filter(!is.na(gdpPercap)) %>%
  filter(year == "1962-01-01")

length(unique(my_gapminder_1962$country))

```

Vi ser her at det kun er 90 land som har data for *gdpPercap* i året 1962.

Under viser vi fordelingen av disse 90 landene, fordelt per kontinent..

```{r continent_1962}
my_gapminder_1962 %>%
distinct(country, continent) %>%
group_by(continent) %>%
count() %>%
kable()
```



